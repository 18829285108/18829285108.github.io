<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Kingvirre">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Kingvirre">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kingvirre">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>Kingvirre</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Kingvirre</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人生自是有情始，此事不关风与月</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/22/uirecorder前端自动化测试/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/22/uirecorder前端自动化测试/" itemprop="url">uirecorder前端自动化测试</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-22T10:49:44+08:00">
                2018-03-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="UIRecorder安装与使用-mac下"><a href="#UIRecorder安装与使用-mac下" class="headerlink" title="UIRecorder安装与使用(mac下)"></a>UIRecorder安装与使用(mac下)</h2><h3 id="安装UIRecorder与录制"><a href="#安装UIRecorder与录制" class="headerlink" title="安装UIRecorder与录制"></a>安装UIRecorder与录制</h3><ol>
<li>将项目clone到本地，首先安装好NodeJs、npm、Chrome浏览器</li>
</ol>
<ul>
<li>主目录下安装uirecorder 和 mocha<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install uirecorder mocha -g</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="2">
<li>PC录制</li>
</ol>
<ul>
<li>主目录下新建文件夹，存放录制的东西</li>
<li><p>初始化uirecorder配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uirecorder init</span><br></pre></td></tr></table></figure>
<p>  一路回车，可以选择测试的浏览器列表等</p>
</li>
<li><p>录制文件，可以修改保存样例文档的名字，会有两个浏览器界面，一个操作，一个展示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uirecorder sample/test.spec.js</span><br></pre></td></tr></table></figure>
</li>
<li><p>Start WebDriver Server</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install selenium-standalone -g 安装</span><br><span class="line">selenium-standalone install</span><br><span class="line">selenium-standalone start</span><br><span class="line">npm run server 运行服务器，服务器需要一直跑在前端</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行测试用例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source run.sh 运行所有测试用例或者指定文件夹 source run.sh sample/test.spec.js</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取回放</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mocha sample/test.spec.js</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取运行报告(reports &amp; screenshots)。在新建文件的report文件夹下面</p>
</li>
</ul>
<h3 id="详细操作步骤"><a href="#详细操作步骤" class="headerlink" title="详细操作步骤"></a>详细操作步骤</h3><ol>
<li>有时间再填写，参考资料里也有别人写的比较不错的。</li>
</ol>
<p>参考资料：
<a href="https://github.com/alibaba/uirecorder" target="_blank" rel="noopener">https://github.com/alibaba/uirecorder</a> 官网
<a href="https://www.jianshu.com/p/e133118c6ea3" target="_blank" rel="noopener">https://www.jianshu.com/p/e133118c6ea3</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/15/github和travis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/15/github和travis/" itemprop="url">github和travis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-15T11:09:36+08:00">
                2018-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="github修改别人的项目并提交到项目上"><a href="#github修改别人的项目并提交到项目上" class="headerlink" title="github修改别人的项目并提交到项目上"></a>github修改别人的项目并提交到项目上</h2><h3 id="基本流程"><a href="#基本流程" class="headerlink" title="基本流程"></a>基本流程</h3><ol>
<li>先fork下别人的代码，于是你的github上就出现了同名的项目，这个项目就属于你自己了。</li>
<li>你把这个自己的项目git clone到本地，修修改改，然后push到你自己的项目里。</li>
<li>在github上你的项目页面有个按钮，叫Pull request，就会把你的修改发到对方的项目里，由原项目主人决定是否接受你的修改。</li>
</ol>
<h3 id="自己和原作者同时修改了项目代码"><a href="#自己和原作者同时修改了项目代码" class="headerlink" title="自己和原作者同时修改了项目代码"></a>自己和原作者同时修改了项目代码</h3><ol>
<li>在本地操作git remote add [sort name] [your url]，意思就是添加第二个远程仓库地址，这个仓库的“昵称”就是你刚指定的[sort name]，</li>
<li>之后push文件，就通过指定这个［sort name］来push到这个你自己的仓库里</li>
<li>等你觉得想要把你改的发给原项目同步，就在你的项目上点Pull request按钮.</li>
<li>如果是，原项目发生了改动，你要想同步到本地，就直接从git fetch origin 从原项目的地址同步代码，然后再merge就好了</li>
<li>当然，你可以通过新建分支的方式往自己的项目上push，这样同步的时候直接fetch就行了</li>
</ol>
<h2 id="travis"><a href="#travis" class="headerlink" title="travis"></a>travis</h2><h3 id="travis简介"><a href="#travis简介" class="headerlink" title="travis简介"></a>travis简介</h3><p>Travis是一个为GitHub服务的CI，支持多数主流语言。</p>
<p>CI即持续集成系统。对个人而言，就是让你的代码在提交到远程(这里是GitHub)后，立即自动编译，并且在失败后可以自动给你发邮件的东西。当然，除了编译，还能做自动化测试、自动部署等。</p>
<p>Travis有两个网址：</p>
<pre><code>https://travis-ci.org/
https://travis-ci.com/
</code></pre><p>org的那个是非盈利的，为GitHub上public的repository提供免费服务；
com的那个是盈利的，可以对private的提供付费服务。com前100次build是免费的，此后按月收费。</p>
<p>二者的账户是相互独立的，但都可以用GitHub账户注册、登录。</p>
<h3 id="操作过程"><a href="#操作过程" class="headerlink" title="操作过程"></a>操作过程</h3><ol>
<li>在travis-ci.org上以GitHub账户注册、登录。</li>
<li>在主页点加号【Add new repository】，添加需要CI的那个库。</li>
<li>在那个库的根目录下，添加一个.travis.yml文件。</li>
</ol>
<p>流程很简明，但绝大多数复杂度都集中在这个.travis.yml文件。这是一个YAML文件，主要用来做CI的配置。Travis会按照这个文件配置的方式来运行。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>可以把Travis看做一个远程服务器。它会监控你添加的GitHub库。如果有新的提交或Pull Request，就会触发一次在线编译。
这台服务器每次都从近乎裸机状态，把你的库clone过来，然后执行其中的.travis.yml。</p>
<p>除了首行的language指定语言类型以外，其它可选的有10个步骤：</p>
<ol>
<li>Install apt addons</li>
<li>before_install</li>
<li>install</li>
<li>before_script</li>
<li>script</li>
<li>after_success or after_failure</li>
<li>OPTIONAL before_deploy</li>
<li>OPTIONAL deploy</li>
<li>OPTIONAL after_deploy</li>
<li>after_script</li>
</ol>
<p>最重要的步骤就是第5步的script，这步通常是测试、编译、打包。
前面的步骤都是为了成功执行第5步而执行的裸机环境配置，后面的步骤都是在执行第5步后而做出的应对。
所有这些步骤，在language设置后基本都有默认值。所以，即使只有一行language: LANG，很多项目也可以build。</p>
<p>另外，如果多次提交同时push，默认只在最新提交执行一次build；在git commit中如果包含[skip ci]或[ci skip]，该提交就不会触发一次build。</p>
<h3 id="README-md"><a href="#README-md" class="headerlink" title="README.md"></a>README.md</h3><p><img src="/2018/03/15/github和travis/1.jpg" alt="build status"></p>
<p>在Travis网站上，点击上面那样的Status图标，可以在弹出界面中得到该项目的状态图标链接。
选择Markdown版本的连接，放到repository的README.md中，就可以在GitHub页面得到编译状态的展示了。</p>
<p>这个链接通常是这种形式：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[![Build Status](https://travis-ci.org/YOUR/PROJECT.svg?branch=master)](https://travis-ci.org/YOUR/PROJECT)</span><br></pre></td></tr></table></figure></p>
<p>上次编译是成功还是失败，从此一目了然。有了这个“勋章”的开源项目，看上去瞬间高大上了。</p>
<p>参考资料:
<a href="http://blog.csdn.net/xiaoyangsavvy/article/details/73775985" target="_blank" rel="noopener">http://blog.csdn.net/xiaoyangsavvy/article/details/73775985</a>
<a href="https://www.jianshu.com/p/c80b37f775a0" target="_blank" rel="noopener">https://www.jianshu.com/p/c80b37f775a0</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/14/单元测试框架unittest/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/14/单元测试框架unittest/" itemprop="url">单元测试框架unittest</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-14T10:40:07+08:00">
                2018-03-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="unittest核心工作原理"><a href="#unittest核心工作原理" class="headerlink" title="unittest核心工作原理"></a>unittest核心工作原理</h3><p><img src="/2018/03/14/单元测试框架unittest/1.jpg" alt="总览"></p>
<p>-</p>
<p>参考资料: <a href="https://huilansame.github.io/huilansame.github.io/category/" target="_blank" rel="noopener">https://huilansame.github.io/huilansame.github.io/category/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/12/python练级第五天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/12/python练级第五天/" itemprop="url">python练级第五天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-12T14:38:03+08:00">
                2018-03-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="python练级打卡第五天"><a href="#python练级打卡第五天" class="headerlink" title="python练级打卡第五天"></a>python练级打卡第五天</h2><h4 id="python程序同时兼容Python2-和-python3"><a href="#python程序同时兼容Python2-和-python3" class="headerlink" title="python程序同时兼容Python2 和 python3"></a>python程序同时兼容Python2 和 python3</h4><ul>
<li>2to3 工具对代码检查（/.pyenv/versions/3.6.2/bin文件下面）
2to3.py是python自带的代码转换工具，将python2代码转换为python3代码，但是代码并未对兼容做任何处理。
python 2to3.py -w + 要转换的python2代码的路径，会直接覆盖掉原先的python2代码，但同时会给原来的python2代码备份。</li>
<li>使用python -3执行python程序
2to3 可以检查出很多python2＆3的兼容性问题，但也有很多问题是2to3发现不了的。
在加上 -3 参数后，程序在运行时会在控制台上将python2和python3不一致，同时2to3无法处理的问题提示出来。
比如python3和python2中对除法的处理规则做过改变。使用-3参数执行4/2将提示 DeprecationWarning: classic int division。</li>
<li>from <strong>future</strong> import
from <strong>future</strong> import print_function: 这样在python2中print(1,2)会输出1和2两个数字，而不是(1，2)一个元组
from <strong>future</strong> import unicode_literals：这样python2中定义普通字符将自动识别为unicode,不用在字符前加u</li>
<li><p>import问题</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">try:#python2</span><br><span class="line">    from UserDict import UserDict</span><br><span class="line">    #建议按照python3的名字进行import</span><br><span class="line">    from UserDict import DictMixin as MutableMapping</span><br><span class="line">except ImportError:#python3</span><br><span class="line">    from collections import UserDict</span><br><span class="line">    from collections import MutableMapping</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据不同的python版本执行不同程序</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">if sys.version &gt; &apos;3&apos;:</span><br><span class="line">    from urllib.parse import urlparse, urlunsplit, urljoin, quote</span><br><span class="line">else:</span><br><span class="line">    from urlparse import urlparse, urlunsplit, urljoin</span><br><span class="line">    from urllib import quote</span><br></pre></td></tr></table></figure>
</li>
<li><p>python2 和 python3编码问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">python2: 只有str和unicode两种类型.str和Unicode分别存储的是字节数据和Unicode数据.</span><br><span class="line">&gt;&gt;&gt; type(&apos;11&apos;)</span><br><span class="line">&lt;type &apos;str&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; type(u&apos;11&apos;)</span><br><span class="line">&lt;type &apos;unicode&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; type(b&apos;11&apos;)</span><br><span class="line">&lt;type &apos;str&apos;&gt;</span><br><span class="line"></span><br><span class="line">python3: 只有str和bytes两种类型。str类型存unicode数据，bytse类型存bytes数据</span><br><span class="line">&gt;&gt;&gt; type(&apos;11&apos;)</span><br><span class="line">&lt;class &apos;str&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; type(u&apos;11&apos;)</span><br><span class="line">&lt;class &apos;str&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; type(b&apos;11&apos;)</span><br><span class="line">&lt;class &apos;bytes&apos;&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="编码问题"><a href="#编码问题" class="headerlink" title="编码问题"></a>编码问题</h4><h5 id="python3编码思想"><a href="#python3编码思想" class="headerlink" title="python3编码思想"></a>python3编码思想</h5><p>Python 3清晰地将文本和二进制数据区分开了，不会对bytes字节串进行自动解码。文本总是Unicode，由str类型表示，二进制数据则由bytes类型表示。
Python 3不会以任意隐式的方式混用str和bytes，将两者明确地区分开。
基于此，Python3中不能拼接字符串和字节包，也不可以在字节包里搜索字符串（反之亦然），也不能向使用字符串参数的函数中传入字节包参数（反之亦然）。</p>
<h5 id="文件存储读取过程中的编码问题"><a href="#文件存储读取过程中的编码问题" class="headerlink" title="文件存储读取过程中的编码问题"></a>文件存储读取过程中的编码问题</h5><ul>
<li>对于文本编辑器word等软件，当我们在这些软件上编辑文字的时候，数据是通过unicode数据存在的，
为什么要存unicode数据，这是因为无论世界上的任何字符它都有唯一编码对应，兼容性是最好的。</li>
<li>当我们保存了存到磁盘上的数据是通过某种编码方式编码的bytes字节串。
比如utf8-－－一种可变长编码，很好的节省了空间；还可以是gbk等编码方式。</li>
<li>当我们保存的时候，这些编辑软件已经”默默地”做了编码工作。那当我们再打开这个文件时，软件又默默地给我们做了解码的工作，将数据再解码成unicode,然后就可以呈现明文给用户了。</li>
<li>unicode是离用户更近的数据，bytes是离计算机更近的数据。</li>
</ul>
<h5 id="python2版本，UnicodeEncodeError-‘ascii’-codec-can’t-encode异常错误"><a href="#python2版本，UnicodeEncodeError-‘ascii’-codec-can’t-encode异常错误" class="headerlink" title="python2版本，UnicodeEncodeError: ‘ascii’ codec can’t encode异常错误"></a>python2版本，<strong>UnicodeEncodeError: ‘ascii’ codec can’t encode异常错误</strong></h5><p>  是因为Unicode编码与ASCII编码的不兼容，以下三行解决问题。
    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(&apos;utf-8&apos;)</span><br></pre></td></tr></table></figure></p>
<h5 id="python2-str和unicode转换"><a href="#python2-str和unicode转换" class="headerlink" title="python2:str和unicode转换"></a>python2:str和unicode转换</h5><ul>
<li><p>str转换为unicode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = &apos;11&apos;</span><br><span class="line">&gt;&gt;&gt; a.decode()</span><br><span class="line">u&apos;11&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>unicode转换为str</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; b = u&apos;11&apos;</span><br><span class="line">&gt;&gt;&gt; b.encode()</span><br><span class="line">&apos;11&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="python3-str和bytes转换"><a href="#python3-str和bytes转换" class="headerlink" title="python3:str和bytes转换"></a>python3:str和bytes转换</h5><ul>
<li><p>str转换为bytes</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a=&apos;abc&apos;</span><br><span class="line">&gt;&gt;&gt; b = str.encode(a)</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">b&apos;abc&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>bytes转换为str</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; b</span><br><span class="line">b&apos;abc&apos;</span><br><span class="line">&gt;&gt;&gt; c = bytes.decode(b)</span><br><span class="line">&gt;&gt;&gt; c</span><br><span class="line">&apos;abc&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h5><ul>
<li>base64: 是常见的二进制编码方法，是一种用64个字符来表示任意二进制数据的方法。
Base64是一种任意二进制到文本字符串的编码方法，常用于在URL、Cookie、网页中传输少量二进制数据。
Base64编码会把3字节的二进制数据编码为4字节的文本数据，长度增加33%，好处是编码后的文本数据可以在邮件正文、网页等直接显示。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">4个子节的bytes数据，补了两个==，代表补了两个字节，一共6个字节。</span><br><span class="line">&gt;&gt;&gt; base64.b64encode(b&apos;abcd&apos;)</span><br><span class="line">b&apos;YWJjZA==&apos;</span><br><span class="line">&gt;&gt;&gt; base64.b64decode(b&apos;YWJjZA==&apos;)</span><br><span class="line">b&apos;abcd&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>由于标准的Base64编码后可能出现字符+和/，在URL中就不能直接作为参数，所以又有一种”url safe”的base64编码，其实就是把字符+和/分别变成-和_：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; base64.b64encode(b&apos;i\xb7\x1d\xfb\xef\xff&apos;)</span><br><span class="line">b&apos;abcd++//&apos;</span><br><span class="line">&gt;&gt;&gt; base64.urlsafe_b64encode(b&apos;i\xb7\x1d\xfb\xef\xff&apos;)</span><br><span class="line">b&apos;abcd--__&apos;</span><br><span class="line">&gt;&gt;&gt; base64.urlsafe_b64decode(&apos;abcd--__&apos;)</span><br><span class="line">b&apos;i\xb7\x1d\xfb\xef\xff&apos;</span><br></pre></td></tr></table></figure></p>
<h5 id="urllib"><a href="#urllib" class="headerlink" title="urllib"></a>urllib</h5><ul>
<li>urllib: 就是利用程序去执行各种HTTP请求。如果要模拟浏览器完成特定功能，需要把请求伪装成浏览器。伪装的方法是先监控浏览器发出的请求，再根据浏览器的请求头来伪装，User-Agent头就是用来标识浏览器的。</li>
<li>urllib的request模块可以非常方便地抓取URL内容，也就是发送一个GET请求到指定的页面，然后返回HTTP的响应.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from urllib import request</span><br><span class="line">&gt;&gt;&gt; f =request.urlopen(&apos;https://api.douban.com/v2/book/2129650&apos;)</span><br><span class="line">&gt;&gt;&gt; f.status</span><br><span class="line">200</span><br><span class="line">&gt;&gt;&gt; f.reason</span><br><span class="line">&apos;OK&apos;</span><br><span class="line">&gt;&gt;&gt; f.getheaders()</span><br><span class="line">[(&apos;Date&apos;, &apos;Mon, 12 Mar 2018 07:44:55 GMT&apos;), (&apos;Content-Type&apos;, &apos;application/json; charset=utf-8&apos;)...]</span><br><span class="line">&gt;&gt;&gt; print(&apos;Data:&apos;, f.read().decode(&apos;utf-8&apos;))</span><br><span class="line">Data: &#123;&quot;rating&quot;:&#123;&quot;max&quot;:10,&quot;numRaters&quot;:16,&quot;average&quot;:&quot;7.4&quot;,&quot;min&quot;:0&#125;,&quot;subtitle&quot;:&quot;&quot;,...&#125;</span><br><span class="line">utf-8解码</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>如果我们要想模拟浏览器发送GET请求，就需要使用Request对象，通过往Request对象添加HTTP头，我们就可以把请求伪装成浏览器
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from urllib import request</span><br><span class="line">req = request.Request(&apos;http://www.douban.com/&apos;)</span><br><span class="line">req.add_header(&apos;User-Agent&apos;, &apos;Mozilla/6.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/8.0 Mobile/10A5376e Safari/8536.25&apos;)</span><br><span class="line">f = request.urlopen(req)</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>post
如果要以POST发送一个请求，只需要把参数data以bytes形式传入。</p>
</li>
<li><p>Handler: 如果还需要更复杂的控制，比如通过一个Proxy去访问网站，我们需要利用ProxyHandler来处理
<strong>其实还是不太理解。以后遇到再说吧</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">proxy_handler = urllib.request.ProxyHandler(&#123;&apos;http&apos;: &apos;http://www.example.com:3128/&apos;&#125;)</span><br><span class="line">proxy_auth_handler = urllib.request.ProxyBasicAuthHandler()</span><br><span class="line">proxy_auth_handler.add_password(&apos;realm&apos;, &apos;host&apos;, &apos;username&apos;, &apos;password&apos;)</span><br><span class="line">opener = urllib.request.build_opener(proxy_handler, proxy_auth_handler)</span><br><span class="line">with opener.open(&apos;http://www.example.com/login.html&apos;) as f:</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h4><ul>
<li>assert x &gt; 0, “错误:x小于等于0”
如果不满足断言里条件，输出后面的报错。
assert + 条件表达式 + 不满足条件时输出报错(可以自己写)。</li>
</ul>
<h4 id="小知识"><a href="#小知识" class="headerlink" title="小知识"></a>小知识</h4><ul>
<li><p>parser.parse_args():定义了所有参数之后，你就可以给 parse_args()传递一组参数字符串来解析命令行。
parse_args() 的返回值是一个命名空间，包含传递给命令的参数。
该对象将参数保存其属性，因此如果你的参数 dest 是 “myoption”，那么你就可以args.myoption 来访问该值。</p>
</li>
<li><p>gevent.pool.pool()
线程问题</p>
</li>
<li><p>enumerate(sequence, [start=0])</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequence -- 一个序列、迭代器或其他支持迭代对象, start -- 下标起始位置</span><br><span class="line">&gt;&gt;&gt;seasons = [&apos;Spring&apos;, &apos;Summer&apos;, &apos;Fall&apos;, &apos;Winter&apos;]</span><br><span class="line">&gt;&gt;&gt;list(enumerate(seasons))</span><br><span class="line">[(0, &apos;Spring&apos;), (1, &apos;Summer&apos;), (2, &apos;Fall&apos;), (3, &apos;Winter&apos;)]</span><br><span class="line">&gt;&gt;&gt;list(enumerate(seasons, start=1))       # 小标从 1 开始</span><br><span class="line">[(1, &apos;Spring&apos;), (2, &apos;Summer&apos;), (3, &apos;Fall&apos;), (4, &apos;Winter&apos;)]</span><br></pre></td></tr></table></figure>
</li>
<li><p>zip([iterable, …]),iterabl – 一个或多个迭代器，返回元组列表。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;a = [1,2,3]</span><br><span class="line">&gt;&gt;&gt; b = [4,5,6]</span><br><span class="line">&gt;&gt;&gt; c = [4,5,6,7,8]</span><br><span class="line">&gt;&gt;&gt; zipped = zip(a,b)     # 打包为元组的列表</span><br><span class="line">[(1, 4), (2, 5), (3, 6)]</span><br><span class="line">&gt;&gt;&gt; zip(a,c)              # 元素个数与最短的列表一致</span><br><span class="line">[(1, 4), (2, 5), (3, 6)]</span><br><span class="line">&gt;&gt;&gt; zip(*zipped)          # 与 zip 相反，可理解为解压，返回二维矩阵式</span><br><span class="line">[(1, 2, 3), (4, 5, 6)]</span><br></pre></td></tr></table></figure>
</li>
<li><p>isinstance:来判断一个对象是否是一个已知的类型，类似 type()
type() 不会认为子类是一种父类类型，不考虑继承关系。
isinstance() 会认为子类是一种父类类型，考虑继承关系。如果要判断两个类型是否相同推荐使用 isinstance()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;a = 2</span><br><span class="line">&gt;&gt;&gt; isinstance (a,int)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance (a,str)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; isinstance (a,(str,int,list))    # 是元组中的一个返回 True</span><br><span class="line">True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">type() 与 isinstance()区别：</span><br><span class="line">class A:</span><br><span class="line">    pass</span><br><span class="line">class B(A):</span><br><span class="line">    pass</span><br><span class="line">isinstance(A(), A)    # returns True</span><br><span class="line">type(A()) == A        # returns True</span><br><span class="line">isinstance(B(), A)    # returns True</span><br><span class="line">type(B()) == A        # returns False</span><br></pre></td></tr></table></figure>
</li>
<li><p>ljust:返回一个原字符串左对齐,并使用空格填充至指定长度的新字符串。如果指定的长度小于原字符串的长度则返回原字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str.ljust(width[, fillchar]) width为指定字符串长度，fillchar为填充字符，默认为空格。</span><br><span class="line">str = &quot;this is string example....wow!!!&quot;;</span><br><span class="line">print str.ljust(50, &apos;0&apos;);</span><br><span class="line">this is string example....wow!!!000000000000000000</span><br></pre></td></tr></table></figure>
</li>
<li><p>os.path.dirname(path): 返回path的目录。其实就是os.path.split(path)的第一个元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import os</span><br><span class="line">&gt;&gt;&gt; os.path.dirname(&apos;C://ss/ss&apos;)</span><br><span class="line">&apos;C://ss&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>os.chdir() 方法用于改变当前工作目录到指定的路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import os, sys</span><br><span class="line">path = &quot;/tmp&quot;</span><br><span class="line"></span><br><span class="line"># 查看当前工作目录</span><br><span class="line">retval = os.getcwd()</span><br><span class="line">print &quot;当前工作目录为 %s&quot; % retval</span><br><span class="line"></span><br><span class="line"># 修改当前工作目录</span><br><span class="line">os.chdir( path )</span><br><span class="line"></span><br><span class="line"># 查看修改后的工作目录</span><br><span class="line">retval = os.getcwd()</span><br><span class="line"></span><br><span class="line">print &quot;目录修改成功 %s&quot; % retval</span><br></pre></td></tr></table></figure>
</li>
<li><p>sys.exit()和os.exit()
os._exit()会直接将python程序终止，之后的所有代码都不会继续执行。
sys.exit()会引发一个异常：SystemExit，如果这个异常没有被捕获，那么python解释器将会退出。
如果有捕获此异常的代码，那么这些代码还是会执行。捕获这个异常可以做一些额外的清理工作。0为正常退出，其他数值（1-127）为不正常，可抛异常事件供捕获.</p>
</li>
</ul>
<p>一般情况下使用sys.exit()即可，一般在fork出来的子进程中使用os._exit()
一般来说os._exit() 用于在线程中退出
sys.exit() 用于在主线程中退出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exit(0)：无错误退出</span><br><span class="line">exit(1)：有错误退出</span><br><span class="line">退出代码是告诉解释器的（或操作系统）</span><br></pre></td></tr></table></figure>
<ul>
<li>os.path.exists() 用于判断变量、文件等是否存在</li>
<li>os.path.normpath(path)规范化路径</li>
<li><p>os.path.join(path1[, path2[, …]]): 将多个路径组合后返回，第一个绝对路径之前的参数将被忽略。</p>
</li>
<li><p>urlparse: 该函数将一个url字符串分解为6个元素，以元组的形式返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python3.6.2</span><br><span class="line">&gt;&gt;&gt; from urllib.parse import urlparse</span><br><span class="line">&gt;&gt;&gt; o = urlparse(&apos;http://www.cwi.nl:80/%7Eguido/Python.html&apos;)</span><br><span class="line">&gt;&gt;&gt; o</span><br><span class="line">ParseResult(scheme=&apos;http&apos;, netloc=&apos;www.cwi.nl:80&apos;, path=&apos;/%7Eguido/Python.html&apos;, params=&apos;&apos;, query=&apos;&apos;, fragment=&apos;&apos;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>quote: 编码：urllib.quote(string[, safe])，除了三个符号“_.-”外，将所有符号编码，(按照当前编码格式下的方式编码),后面的参数safe是不编码的字符，
使用的时候如果不设置的话，会将斜杠，冒号，等号，问号都给编码了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from urllib.parse import quote</span><br><span class="line">&gt;&gt;&gt; quote(&quot;http://neeao.com/index.php?id=1&quot;)</span><br><span class="line">&apos;http%3A//neeao.com/index.php%3Fid%3D1&apos;</span><br><span class="line">&gt;&gt;&gt; quote(&quot;http://neeao.com/index.php?id=1&quot;,&quot;:?=/&quot;) #将&apos;?=/&apos;不参与编码</span><br><span class="line">&apos;http://neeao.com/index.php?id=1&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>json.loads、load、dumps、dump</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">json.dumps : dict转成str     json.dump是将python数据保存成json</span><br><span class="line">json.loads:str转成dict          json.load是读取json数据</span><br></pre></td></tr></table></figure>
</li>
<li><p>repr() 函数将对象转化为供解释器读取的形式。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/06/python练级第四天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/06/python练级第四天/" itemprop="url">python练级第四天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-06T10:30:39+08:00">
                2018-03-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="python练级打卡第四天"><a href="#python练级打卡第四天" class="headerlink" title="python练级打卡第四天"></a>python练级打卡第四天</h2><h4 id="python的假多线程"><a href="#python的假多线程" class="headerlink" title="python的假多线程"></a>python的假多线程</h4><ol>
<li>对所有面向I/O的（会调用内建的操作系统C代码的）程序来说，GIL会在这个I/O调用之前被释放，以允许其他线程在这个线程等待I/O的时候运行。
如果某线程并未使用很多I/O操作，它会在自己的时间片内一直占用处理器和GIL。所以说，I/O密集型的Python程序比计算密集型的Python程序更能充分利用多线程的好处。</li>
<li>python线程不能利用多核，进程可以利用多核。java线程和进程都可以利用多核。</li>
<li>Python多线程相当于单核多线程，多线程有两个好处：CPU并行，I/O并行，单核多线程相当于自断一臂。
所以，在Python中，可以使用多线程，但不要指望能有效利用多核。如果一定要通过多线程利用多核，那只能通过C扩展来实现，不过这样就失去了Python简单易用的特点。
不过，也不用过于担心，Python虽然不能利用多线程实现多核任务，但可以通过多进程实现多核任务。多个Python进程有各自独立的GIL锁，互不影响。</li>
</ol>
<h4 id="map和reduce"><a href="#map和reduce" class="headerlink" title="map和reduce"></a>map和reduce</h4><ol>
<li><p>map()函数接收两个参数，一个是函数，一个是Iterable，map将传入的函数依次作用到序列的每个元素，并把结果作为新的Iterator返回。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">把这个list所有数字转为字符串</span><br><span class="line">&gt;&gt;&gt; list(map(str, [1, 2, 3, 4, 5, 6, 7, 8, 9]))</span><br><span class="line">[&apos;1&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;, &apos;5&apos;, &apos;6&apos;, &apos;7&apos;, &apos;8&apos;, &apos;9&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>reduce把一个函数作用在一个序列[x1, x2, x3, …]上，这个函数必须接收两个参数，reduce把结果继续和序列的下一个元素做累积计算。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">reduce(f, [x1, x2, x3, x4]) = f(f(f(x1, x2), x3), x4)</span><br><span class="line"></span><br><span class="line">from functools import reduce</span><br><span class="line"></span><br><span class="line">DIGITS = &#123;&apos;0&apos;: 0, &apos;1&apos;: 1, &apos;2&apos;: 2, &apos;3&apos;: 3, &apos;4&apos;: 4, &apos;5&apos;: 5, &apos;6&apos;: 6, &apos;7&apos;: 7, &apos;8&apos;: 8, &apos;9&apos;: 9&#125;</span><br><span class="line"></span><br><span class="line">def char2num(s):</span><br><span class="line">    return DIGITS[s]</span><br><span class="line"></span><br><span class="line">def str2int(s):</span><br><span class="line">    return reduce(lambda x, y: x * 10 + y, map(char2num, s))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; str2int(&apos;13579&apos;)</span><br><span class="line">13579</span><br></pre></td></tr></table></figure>
<blockquote>
<p>lambda基础:lambda语句中，冒号前是参数，可以有多个，用逗号隔开，冒号右边是返回值。lambda语句构建的其实是一个函数对象.
   lambda就是匿名函数，只有表达式。</p>
</blockquote>
</li>
</ol>
<ol start="3">
<li>练习题 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">利用map和reduce编写一个str2float函数，把字符串&apos;123.456&apos;转换成浮点数123.456：</span><br><span class="line"></span><br><span class="line">int_part, dec_part = s.split(&apos;.&apos;)</span><br><span class="line">    return reduce(lambda x, y: 10*x+y, map(int, int_part)) + \</span><br><span class="line">           reduce(lambda x, y: 10*x+y, map(int, dec_part))*10**(-len(dec_part))</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><ol>
<li><p>和map()类似，filter()也接收一个函数和一个序列。和map()不同的是，filter()把传入的函数依次作用于每个元素，然后根据返回值是True还是False决定保留还是丢弃该元素。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">筛选素数的函数。注意filter里面的用法。</span><br><span class="line">&gt;&gt;&gt; def _odd_iter():</span><br><span class="line">...     n = 1</span><br><span class="line">...     while True:</span><br><span class="line">...         n = n + 2</span><br><span class="line">...         yield n</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; def _not_divisible(n):</span><br><span class="line">...     return lambda x: x % n &gt; 0</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; def primes():</span><br><span class="line">...     yield 2</span><br><span class="line">...     it = _odd_iter() # 初始序列</span><br><span class="line">...     while True:</span><br><span class="line">...         n = next(it) # 返回序列的第一个数</span><br><span class="line">...         yield n</span><br><span class="line">...         it = filter(_not_divisible(n), it)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
<li><p>sorted()函数，高阶函数，默认排序从小到大，用sorted()排序的关键在于实现一个映射函数。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sorted([36, 5, -12, 9, -21])</span><br><span class="line">[-21, -12, 5, 9, 36]</span><br><span class="line">&gt;&gt;&gt; sorted([36, 5, -12, 9, -21], key=abs)</span><br><span class="line">[5, 9, -12, -21, 36]</span><br><span class="line">要进行反向排序，不必改动key函数，可以传入第三个参数reverse=True：</span><br><span class="line">&gt;&gt;&gt; sorted([&apos;bob&apos;, &apos;about&apos;, &apos;Zoo&apos;, &apos;Credit&apos;], key=str.lower, reverse=True)</span><br><span class="line">[&apos;Zoo&apos;, &apos;Credit&apos;, &apos;bob&apos;, &apos;about&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>map、reduce和filter都可以用于对大数据的处理。</p>
</li>
</ol>
<h4 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h4><ol>
<li><p>下面样例原因: 在于返回的函数引用了变量i，但它并非立刻执行。等到3个函数都返回时，它们所引用的变量i已经变成了3，因此最终结果为9。
返回闭包时牢记: 返回函数不用引用任何循环变量，或者后续会发生变化的变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">def count():</span><br><span class="line">    fs = []</span><br><span class="line">    for i in range(1, 4):</span><br><span class="line">        def f():</span><br><span class="line">             return i*i</span><br><span class="line">        fs.append(f)</span><br><span class="line">    return fs</span><br><span class="line"></span><br><span class="line">f1, f2, f3 = count()</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; f1()</span><br><span class="line">9</span><br><span class="line">&gt;&gt;&gt; f2()</span><br><span class="line">9</span><br><span class="line">&gt;&gt;&gt; f3()</span><br><span class="line">9</span><br></pre></td></tr></table></figure>
</li>
<li><p>利用闭包返回一个计数器函数，每次调用它返回递增整数</p>
</li>
</ol>
<ul>
<li>内部函数一般无法修改外部函数的参数</li>
<li>想要修改需要声明 nonlocal</li>
<li>内部函数可以修改外部list中的元素<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def createCounter():</span><br><span class="line">    s=0</span><br><span class="line">    def counter():</span><br><span class="line">        s[0]+=1</span><br><span class="line">        return s[0]</span><br><span class="line">    return counter</span><br><span class="line"></span><br><span class="line">counterA = createCounter()</span><br><span class="line">&gt;&gt;&gt; print(counterA(), counterA(), counterA(), counterA())</span><br><span class="line">&gt;&gt;&gt; 1 2 3 4</span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/02/python练级第三天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/02/python练级第三天/" itemprop="url">python练级第三天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-02T20:03:38+08:00">
                2018-03-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="python练级打卡第三天"><a href="#python练级打卡第三天" class="headerlink" title="python练级打卡第三天"></a>python练级打卡第三天</h2><p>把平时用到的地方再简单整理下</p>
<h4 id="把字符串类型的字典，转换为字典类型"><a href="#把字符串类型的字典，转换为字典类型" class="headerlink" title="把字符串类型的字典，转换为字典类型"></a>把字符串类型的字典，转换为字典类型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = &apos;&#123;&quot;hostname&quot;: &quot;172.16.83.200&quot;, &quot;cert_id&quot;: null, &quot;policy&quot;: null, &quot;listener_id&quot;: 5&#125;&apos;</span><br><span class="line">&gt;&gt;&gt; type(a)</span><br><span class="line">&lt;class &apos;str&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; import json</span><br><span class="line">&gt;&gt;&gt; b = json.loads(a)</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">&#123;&apos;hostname&apos;: &apos;172.16.83.200&apos;, &apos;cert_id&apos;: None, &apos;policy&apos;: None, &apos;listener_id&apos;: 5&#125;</span><br><span class="line">&gt;&gt;&gt; type(b)</span><br><span class="line">&lt;class &apos;dict&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; c = eval(a)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">NameError: name &apos;null&apos; is not defined</span><br></pre></td></tr></table></figure>
<p>null有报错，需要把null改写成python可接受的字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = &apos;&#123;&quot;hostname&quot;: &quot;172.16.83.200&quot;, &quot;cert_id&quot;: &quot;2&quot;, &quot;policy&quot;: &quot;2&quot;, &quot;listener_id&quot;: 5&#125;&apos;</span><br><span class="line">&gt;&gt;&gt; c = eval(a)</span><br><span class="line">&gt;&gt;&gt; c</span><br><span class="line">&#123;&apos;hostname&apos;: &apos;172.16.83.200&apos;, &apos;cert_id&apos;: &apos;2&apos;, &apos;policy&apos;: &apos;2&apos;, &apos;listener_id&apos;: 5&#125;</span><br><span class="line">&gt;&gt;&gt; type(c)</span><br><span class="line">&lt;class &apos;dict&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; import ast</span><br><span class="line">&gt;&gt;&gt; d = ast.literal_eval(a)</span><br><span class="line">&gt;&gt;&gt; d</span><br><span class="line">&#123;&apos;hostname&apos;: &apos;172.16.83.200&apos;, &apos;cert_id&apos;: &apos;2&apos;, &apos;policy&apos;: &apos;2&apos;, &apos;listener_id&apos;: 5&#125;</span><br><span class="line">&gt;&gt;&gt; type(d)</span><br><span class="line">&lt;class &apos;dict&apos;&gt;</span><br></pre></td></tr></table></figure>
<h4 id="时间转换"><a href="#时间转换" class="headerlink" title="时间转换"></a>时间转换</h4><ol>
<li><p>datetime</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from datetime import datetime</span><br><span class="line">&gt;&gt;&gt; a = datetime.now()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.datetime(2018, 3, 2, 12, 1, 42, 699013)</span><br><span class="line">&gt;&gt;&gt; type(a)</span><br><span class="line">&lt;class &apos;datetime.datetime&apos;&gt;</span><br></pre></td></tr></table></figure>
<p> 对时间进行加减。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from datetime import datetime, timedelta</span><br><span class="line">&gt;&gt;&gt; datetime.now() + timedelta(days = 1)</span><br><span class="line">datetime.datetime(2018, 3, 3, 12, 4, 17, 475267)</span><br><span class="line">&gt;&gt;&gt; datetime.now() + timedelta(hours = 1)</span><br><span class="line">datetime.datetime(2018, 3, 2, 13, 4, 26, 785818)</span><br><span class="line">&gt;&gt;&gt; datetime.now() + timedelta(days = 1,hours = 1)</span><br><span class="line">datetime.datetime(2018, 3, 3, 13, 4, 41, 755995)</span><br></pre></td></tr></table></figure>
</li>
<li><p>时间戳（float）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import time</span><br><span class="line">&gt;&gt;&gt; t = time.time()</span><br><span class="line">&gt;&gt;&gt; t</span><br><span class="line">1519962961.725776</span><br><span class="line">&gt;&gt;&gt; type(t)</span><br><span class="line">&lt;class &apos;float&apos;&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串（eg: 2018-01-01）</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = time.localtime()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">time.struct_time(tm_year=2018, tm_mon=3, tm_mday=2, tm_hour=14, tm_min=50, tm_sec=55, tm_wday=4, tm_yday=61, tm_isdst=0)</span><br><span class="line">&gt;&gt;&gt; type(a)</span><br><span class="line">&lt;class &apos;time.struct_time&apos;&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以将struct_time转变为str类型，strftime可以将时间转换为我们需要的格式</p>
</blockquote>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; time.strftime(&apos;%Y-%m-%d&apos;,a)</span><br><span class="line">&apos;2018-03-02&apos;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>将str类型转变为struct_time。strptime函数根据指定的格式把一个时间字符串解析为时间元组。</p>
</blockquote>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b = time.strptime(&apos;2018-01-01&apos;, &apos;%Y-%m-%d&apos;)</span><br><span class="line">&gt;&gt;&gt; type(b)</span><br><span class="line">&lt;class &apos;time.struct_time&apos;&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>各种时间之间的转换</p>
</li>
</ol>
<ul>
<li><p>datetime 转 str（eg: 2018-01-01）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; q=datetime.now().strftime(&apos;%Y-%m-%d&apos;)</span><br><span class="line">&gt;&gt;&gt; q</span><br><span class="line">&apos;2018-03-02&apos;</span><br><span class="line">&gt;&gt;&gt; type(q)</span><br><span class="line">&lt;class &apos;str&apos;&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>str转datetime, 转换后的datetime没有时区</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; c = datetime.strptime(&apos;2018-3-2 12:33:59&apos;, &apos;%Y-%m-%d %H:%M:%S&apos;)</span><br><span class="line">&gt;&gt;&gt; c</span><br><span class="line">datetime.datetime(2018, 3, 2, 12, 33, 59)</span><br><span class="line">&gt;&gt;&gt; type(c)</span><br><span class="line">&lt;class &apos;datetime.datetime&apos;&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>datetime转时间戳</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; d = datetime.now().timestamp()</span><br><span class="line">&gt;&gt;&gt; d</span><br><span class="line">1519965586.116359</span><br><span class="line">&gt;&gt;&gt; type(d)</span><br><span class="line">&lt;class &apos;float&apos;&gt;</span><br><span class="line"></span><br><span class="line">第二种方法如下：比较麻烦</span><br><span class="line">&gt;&gt;&gt; e = time.mktime(datetime.now().timetuple())</span><br><span class="line">&gt;&gt;&gt; e</span><br><span class="line">1519974113.0</span><br><span class="line">&gt;&gt;&gt; type(e)</span><br><span class="line">&lt;class &apos;float&apos;&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>时间戳转datetime,e为本地时间，f为UTC时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; d = 1519965586.116359</span><br><span class="line">&gt;&gt;&gt; e = datetime.fromtimestamp(d)</span><br><span class="line">&gt;&gt;&gt; e</span><br><span class="line">datetime.datetime(2018, 3, 2, 12, 39, 46, 116359)</span><br><span class="line">&gt;&gt;&gt; type(e)</span><br><span class="line">&lt;class &apos;datetime.datetime&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; f = datetime.utcfromtimestamp(d)</span><br><span class="line">&gt;&gt;&gt; f</span><br><span class="line">datetime.datetime(2018, 3, 2, 4, 39, 46, 116359)</span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/28/django入门学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/28/django入门学习/" itemprop="url">django入门学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-28T11:34:31+08:00">
                2018-02-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="demo项目"><a href="#demo项目" class="headerlink" title="demo项目"></a>demo项目</h2><h4 id="guest-urls-py-url请求映射表，除了项目的根目录下有urls-py外，项目的每个应用下都会有一个urls-py文件。"><a href="#guest-urls-py-url请求映射表，除了项目的根目录下有urls-py外，项目的每个应用下都会有一个urls-py文件。" class="headerlink" title="guest/urls.py: url请求映射表，除了项目的根目录下有urls.py外，项目的每个应用下都会有一个urls.py文件。"></a>guest/urls.py: url请求映射表，除了项目的根目录下有urls.py外，项目的每个应用下都会有一个urls.py文件。</h4><ul>
<li>浏览器发送请求url</li>
<li>服务端根据请求的url，在项目的所有应用（包括根目录）的urls.py配置文件中进行查找，如果能匹配到该url，就会将该url交给其对应的视图函数进行处理。</li>
<li><p>负责处理该url的视图函数，会搜集一些业务数据，然后把这些数据，通过return render(request, ‘模板文件’, 数据); 渲染到前端页面展示给用户。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = patterns(&apos;视图前缀&apos;,</span><br><span class="line">    url(r&apos;^正则表达式1/$&apos;, &apos;视图函数1&apos;, name=&quot;url标识1&quot;),</span><br><span class="line">    url(r&apos;^正则表达式2/$&apos;, &apos;视图函数2&apos;, name=&quot;url标识2&quot;),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：
  1.patterns函数的第一个参数表示视图前缀，视图前缀可以为空，之后跟上若干个url函数，每个url函数表示一个请求映射关系。
  2.url函数的第二个参数，表示视图函数，它的名字不是随便取的，必须要在views.py中真实存在，项目的每个应用下都会有一个views.py文件。
  3.views.py文件中的视图函数，其第一个参数必须是HttpRequest对象。
  4.name的作用主要体现在一个视图函数对应多个url请求的场景中，name可以用来唯一标识一个url，所以它必须全局唯一。</p>
</blockquote>
</li>
</ul>
<h4 id="url中include使用"><a href="#url中include使用" class="headerlink" title="url中include使用"></a>url中include使用</h4><p>假如一个project中有多个app, 我们可以用include的方法来配置url，首先我们在自己的app中建立一个urls.py，即myproject/myapp/目录下建立urls.py.
然后在项目的根目录下urls中包含刚刚app中添加的url配置，我们要做的是在myproject/myproject/urls.py输入如下内容:
    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from django.conf.urls import url, include #导入了include函数</span><br><span class="line">from django.contrib import admin</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&apos;^admin/&apos;, admin.site.urls),</span><br><span class="line">    url(r&apos;^myapp/&apos;, include(&quot;myapp.urls&quot;))#包含myapp中的urls</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<h4 id="module数据库的迁移。"><a href="#module数据库的迁移。" class="headerlink" title="module数据库的迁移。"></a>module数据库的迁移。</h4><ul>
<li><p>修改models.py后，需要执行以下两步进行数据库迁移.
第一个是makemigrations，第二个是migrate，生成migrations代码的makemigrations指令是用models里面的model和当前的migrations代码里面的model做对比，如果有新的修改，就生成新的migrations代码，
migrate指令是用migrations目录中代码文件和django数据库djaong_migrations表中的代码文件做对比，如果表中没有，那就对这些没有的文件按顺序及依赖关系做migrate apply，然后再把代码文件名加进migrations表中。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 在该app下建立 migrations目录，并记录下你所有的关于models.py的改动，比如0001_initial.py， 但是这个改动还没有作用到数据库文件</span><br><span class="line">python manage.py makemigrations + app名称</span><br><span class="line"># 将改动作用到数据库</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>
</li>
<li><p>settings.py ,DATABASES设置数据库</p>
</li>
<li>删除数据库db.sqlite3后, 需要创建登录后台的管理员账号  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="连接两个表之间的外键。"><a href="#连接两个表之间的外键。" class="headerlink" title="连接两个表之间的外键。"></a>连接两个表之间的外键。</h4><pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from django.db import models</span><br><span class="line"></span><br><span class="line">class Reporter(models.Model):</span><br><span class="line">    full_name = models.CharField(max_length=70)</span><br><span class="line"></span><br><span class="line">    def __str__(self):</span><br><span class="line">        return self.full_name</span><br><span class="line"></span><br><span class="line">class Article(models.Model):</span><br><span class="line">    pub_date = models.DateField()</span><br><span class="line">    headline = models.CharField(max_length=200)</span><br><span class="line">    reporter = models.ForeignKey(Reporter)</span><br><span class="line"></span><br><span class="line">    def __str__(self):</span><br><span class="line">        return self.headline</span><br><span class="line"></span><br><span class="line"> &gt;&gt;&gt; r = Reporter(full_name=&apos;John Smith&apos;)</span><br><span class="line"> &gt;&gt;&gt; r.article_set.all()</span><br><span class="line">&lt;QuerySet [&lt;Article: Django is cool&gt;]&gt;</span><br><span class="line">reporter是article的外键，所以reporter的article_set.all可以显示此reporter的所有文章</span><br></pre></td></tr></table></figure>
</code></pre><h4 id="django的模板继承"><a href="#django的模板继承" class="headerlink" title="django的模板继承"></a>django的模板继承</h4><pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &quot;base.html&quot; %&#125;</span><br><span class="line">&#123;% block title %&#125;Articles for &#123;&#123; year &#125;&#125;&#123;% endblock %&#125;</span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">&lt;h1&gt;Articles for &#123;&#123; year &#125;&#125;&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&#123;% for article in article_list %&#125;</span><br><span class="line">    &lt;p&gt;&#123;&#123; article.headline &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;By &#123;&#123; article.reporter.full_name &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;Published &#123;&#123; article.pub_date|date:&quot;F j, Y&quot; &#125;&#125;&lt;/p&gt;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>

&gt; 这就是 % extends &quot;base.html&quot; % 所做的事。它表示“首先载入‘base’ 模板，该模板中定义了一系列block，然后使用接下来的（存在于继承模板）blocks填充这些blocks”。
  简而言之，模板继承让你大大减少模板间的冗余内容：每个模板只需要定义它独特的部分。

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load staticfiles %&#125;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&#123;% block title %&#125;&#123;% endblock %&#125;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;img src=&quot;&#123;% static &quot;images/sitelogo.png&quot; %&#125;&quot; alt=&quot;Logo&quot; /&gt;</span><br><span class="line">    &#123;% block content %&#125;&#123;% endblock %&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

&gt; 它定义网站的外观（使用网站的logo ），并提供“空洞”让子模板填充。这使站点的重构变得非常容易，只需改变一个文件 —— base模板。
  它还可以让你利用不同的基础模板并重用子模板创建一个网站的多个版本(中英文版本等)。
</code></pre><h4 id="admin-py后台管理"><a href="#admin-py后台管理" class="headerlink" title="admin.py后台管理"></a>admin.py后台管理</h4><pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list_display = (&quot;name&quot;, &quot;client_id&quot;, &quot;create_time&quot;, &quot;comment&quot;) # 列表中显示哪些字段</span><br><span class="line">search_fields = [&quot;name&quot;]  # 搜索栏</span><br><span class="line">ordering = (&quot;-create_time&quot;,) # 默认排序字段，负号表示降序排序</span><br></pre></td></tr></table></figure>
</code></pre><h4 id="serializers"><a href="#serializers" class="headerlink" title="serializers"></a>serializers</h4><p>用djangorestframework和js做web api, serializers序列化返回json或者jsonp数据。主要是为了自动地将模型的实例对象序列化，搞成json数据更方便前端使用</p>
<h4 id="django版本问题，"><a href="#django版本问题，" class="headerlink" title="django版本问题，"></a>django版本问题，</h4><p>  提示错误(‘WSGIRequest’ object has no attribute ‘user’) , 需要在settings里面修改MIDDLEWARE或者MIDDLEWARE_CLASSES</p>
<ul>
<li>django1.9之前，中间件的key为MIDDLEWARE_CLASSES</li>
<li>django1.9之后，中间件的key为MIDDLEWARE</li>
</ul>
<h4 id="celery"><a href="#celery" class="headerlink" title="celery"></a>celery</h4><ul>
<li>异步分布式地异步处理任务。参考资料：<a href="http://yshblog.com/blog/163" target="_blank" rel="noopener">http://yshblog.com/blog/163</a></li>
<li>定时执行任务。参考资料：<a href="http://yshblog.com/blog/164" target="_blank" rel="noopener">http://yshblog.com/blog/164</a></li>
</ul>
<h4 id="中间件middleware"><a href="#中间件middleware" class="headerlink" title="中间件middleware"></a>中间件middleware</h4><ul>
<li>参考资料：<a href="http://blog.csdn.net/orangleliu/article/details/48316919" target="_blank" rel="noopener">http://blog.csdn.net/orangleliu/article/details/48316919</a></li>
<li>process response
不像 process_request()和process_view()方法，即使同一个中间件类中的process_request()和process_view()方法会因为前面的一个中间件返回HttpResponse而被跳过，process_response()方法总是会被调用。
在响应阶段中，中间件以相反的顺序被应用，自底向上。意思是定义在MIDDLEWARE_CLASSES最底下的类会最先被运行。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/26/python练级第二天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/26/python练级第二天/" itemprop="url">python练级第二天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-26T12:56:01+08:00">
                2018-02-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="python练级打卡第二天"><a href="#python练级打卡第二天" class="headerlink" title="python练级打卡第二天"></a>python练级打卡第二天</h2><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><ol>
<li><p>函数名其实就是指向一个函数对象的引用，完全可以把函数名赋给一个变量，相当于给这个函数起了一个“别名”。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = abs # 变量a指向abs函数</span><br><span class="line">&gt;&gt;&gt; a(-1) # 所以也可以通过a调用abs函数</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数体内部的语句在执行时，一旦执行到return时，函数就执行完毕，并将结果返回。如果没有return语句，函数执行完毕后也会返回结果，只是结果为None。return None可以简写为return</p>
</li>
<li>如果你已经把my_abs()的函数定义保存为abstest.py文件了，那么，可以在该文件的当前目录下启动Python解释器，用from abstest import my_abs来导入my_abs()函数，注意abstest是文件名（不含.py扩展名）：</li>
<li>函数可以同时返回多个值，但其实就是一个tuple。</li>
<li>参数</li>
</ol>
<ul>
<li>位置参数：调用函数时，传入的多个值按照位置顺序依次赋给多个参数。</li>
<li><p>默认参数：默认参数可以简化函数的调用。<strong>注意</strong>：必选参数在前，默认参数在后。（当函数有多个参数时，把变化大的参数放前面，变化小的参数放后面。变化小的参数就可以作为默认参数。）<strong><em>定义默认参数要牢记一点：默认参数必须指向不变对象！</em></strong></p>
<blockquote>
<p>有多个默认参数时，调用的时候，既可以按顺序提供默认参数。
   也可以不按顺序提供部分默认参数。当不按顺序提供部分默认参数时，需要把参数名写上。</p>
</blockquote>
</li>
<li><p>可变参数：参数个数是可变的，这些可变参数在函数调用时自动组装为一个tuple。比如nums为一个list，*nums表示把nums这个list的所有元素作为可变参数传进去。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">numbers代表list或者tuple</span><br><span class="line">def calc(numbers):</span><br><span class="line">    sum = 0</span><br><span class="line">    for n in numbers:</span><br><span class="line">        sum = sum + n * n</span><br><span class="line">    return sum</span><br><span class="line">    </span><br><span class="line">&gt;&gt;&gt; calc((1, 3, 5, 7))</span><br><span class="line">84</span><br><span class="line"></span><br><span class="line">可变参数，在list或tuple前面加一个*号，把list或tuple的元素变成可变参数传进去。</span><br><span class="line">def calc(*numbers):</span><br><span class="line">    sum = 0</span><br><span class="line">    for n in numbers:</span><br><span class="line">        sum = sum + n * n</span><br><span class="line">    return sum</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; calc(1, 3, 5, 7)</span><br><span class="line">84</span><br></pre></td></tr></table></figure>
</li>
<li><p>关键字参数：试想你正在做一个用户注册的功能，除了用户名和年龄是必填项外，其他都是可选项，利用关键字参数来定义这个函数就能满足注册的需求。允许你传入0个或任意个含参数名的参数，这些关键字参数在函数内部自动组装为一个dict。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">**extra表示把extra这个dict的所有key-value用关键字参数传入到函数的**kw参数，kw将获得一个dict，</span><br><span class="line">注意kw获得的dict是extra的一份拷贝，对kw的改动不会影响到函数外的extra。</span><br><span class="line">&gt;&gt;&gt; extra = &#123;&apos;city&apos;: &apos;Beijing&apos;, &apos;job&apos;: &apos;Engineer&apos;&#125;</span><br><span class="line">&gt;&gt;&gt; person(&apos;Jack&apos;, 24, **extra)</span><br><span class="line">name: Jack age: 24 other: &#123;&apos;city&apos;: &apos;Beijing&apos;, &apos;job&apos;: &apos;Engineer&apos;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>命名关键字参数：如果要限制关键字参数的名字，就可以用命名关键字参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">和关键字参数 **kw 不同，命名关键字参数需要一个特殊分隔符*，*后面的参数被视为命名关键字参数。</span><br><span class="line">例如，只接收city和job作为关键字参数。</span><br><span class="line">def person(name, age, *, city, job):</span><br><span class="line">    print(name, age, city, job)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; person(&apos;Jack&apos;, 24, city=&apos;Beijing&apos;, job=&apos;Engineer&apos;)</span><br><span class="line">Jack 24 Beijing Engineer</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果函数定义中已经有了一个可变参数，后面跟着的命名关键字参数就不再需要一个特殊分隔符了。如果没有可变参数，就必须加一个*作为特殊分隔符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def person(name, age, *args, city, job):</span><br><span class="line">    print(name, age, args, city, job)</span><br><span class="line">    </span><br><span class="line">命名关键字参数必须传入参数名，这和位置参数不同。如果没有传入参数名，调用将报错：</span><br><span class="line">&gt;&gt;&gt; person(&apos;Jack&apos;, 24, &apos;Beijing&apos;, &apos;Engineer&apos;)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">TypeError: person() takes 2 positional arguments but 4 were given</span><br></pre></td></tr></table></figure>
</li>
<li><p>参数组合：参数定义的顺序必须是：必选参数、默认参数、可变参数、命名关键字参数和关键字参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可变参数既可以直接传入：func(1, 2, 3)，又可以先组装list或tuple，再通过*args传入：func(*(1, 2, 3))；</span><br><span class="line">关键字参数既可以直接传入：func(a=1, b=2)，又可以先组装dict，再通过**kw传入：func(**&#123;&apos;a&apos;: 1, &apos;b&apos;: 2&#125;)。</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="6">
<li>递归函数：所有的递归函数都可以写成循环的方式，但循环的逻辑不如递归清晰。</li>
</ol>
<ul>
<li>使用递归函数需要注意防止栈溢出。在计算机中，函数调用是通过栈（stack）这种数据结构实现的，每当进入一个函数调用，栈就会加一层栈帧，每当函数返回，栈就会减一层栈帧。由于栈的大小是有限的，所以，递归调用的次数过多，会导致栈溢出。</li>
<li>解决递归调用栈溢出的方法是通过<strong>尾递归</strong>优化。尾递归是指，在函数返回的时候，调用自身本身，并且，return语句不能包含表达式。这样，编译器或者解释器就可以把尾递归做优化，使递归本身无论调用多少次，都只占用一个栈帧，不会出现栈溢出的情况</li>
<li>Python标准的解释器没有针对尾递归做优化，任何递归函数都存在栈溢出的问题。</li>
</ul>
<h3 id="高级特性"><a href="#高级特性" class="headerlink" title="高级特性"></a>高级特性</h3><h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><ol>
<li><p>取前三个元素。L[0:3]表示，从索引0开始取，直到索引3为止，但不包括索引3。即索引0，1，2，正好是3个元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; L = [&apos;Michael&apos;, &apos;Sarah&apos;, &apos;Tracy&apos;, &apos;Bob&apos;, &apos;Jack&apos;]</span><br><span class="line">&gt;&gt;&gt; L[0:3]</span><br><span class="line">[&apos;Michael&apos;, &apos;Sarah&apos;, &apos;Tracy&apos;]</span><br><span class="line">如果第一个索引是0，还可以省略</span><br><span class="line">&gt;&gt;&gt; L[:3]</span><br><span class="line">[&apos;Michael&apos;, &apos;Sarah&apos;, &apos;Tracy&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>倒数切片。倒数第一个元素的索引是-1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">取倒数第二个到最后所有元素。</span><br><span class="line">&gt;&gt;&gt; L[-2:]</span><br><span class="line">[&apos;Bob&apos;, &apos;Jack&apos;]</span><br><span class="line">&gt;&gt;&gt; L[-2:-1]</span><br><span class="line">[&apos;Bob&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>L[:10:2]代表前10个数，每两个取一个。L[::5]所有数，每5个取一个。L[:]代表复制同样一个list。</p>
</li>
<li><p>字符串’xxx’也可以看成是一种list，每个元素就是一个字符。因此，字符串也可以用切片操作，只是操作结果仍是字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &apos;ABCDEFG&apos;[::2]</span><br><span class="line">&apos;ACEG&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>切片练习题答案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">def trim(str):</span><br><span class="line">...     i = 0;</span><br><span class="line">...     while i &lt;= len(str):</span><br><span class="line">...         if str[i:i+1] == &apos; &apos;:</span><br><span class="line">...             i = i+1;</span><br><span class="line">...         else:</span><br><span class="line">...             break;</span><br><span class="line">...     n = len(str);</span><br><span class="line">...     while n &gt;= 0:</span><br><span class="line">...         if str[n-1:n] == &apos; &apos;:</span><br><span class="line">...             n = n-1;</span><br><span class="line">...         else:</span><br><span class="line">...             break;</span><br><span class="line">...     return str[i:n];</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h4><ol>
<li>给定一个list或tuple，我们可以通过for循环来遍历这个list或tuple，这种遍历我们称为迭代。</li>
<li>任何可迭代对象都可以作用于for循环，包括我们自定义的数据类型，只要符合迭代条件，就可以使用for循环。</li>
<li>默认情况下，dict字典迭代的是key。如果要迭代value，可以用for value in d.values()，如果要同时迭代key和value，可以用for k, v in d.items()</li>
<li><p>判断一个对象是否可迭代，通过collections模块的Iterable类型判断。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from collections import Iterable</span><br><span class="line">&gt;&gt;&gt; isinstance(&apos;abc&apos;, Iterable) # str是否可迭代</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(123, Iterable) # 整数是否可迭代</span><br><span class="line">False</span><br></pre></td></tr></table></figure>
</li>
<li><p>Python内置的<strong>enumerate函数</strong>可以把一个list变成索引-元素对，这样就可以在for循环中同时迭代索引和元素本身</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; for i, value in enumerate([&apos;A&apos;, &apos;B&apos;, &apos;C&apos;]):</span><br><span class="line">...     print(i, value)</span><br><span class="line">...</span><br><span class="line">0 A</span><br><span class="line">1 B</span><br><span class="line">2 C</span><br></pre></td></tr></table></figure>
</li>
<li><p>迭代练习题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def findMinAndMax(L):</span><br><span class="line">...     if L==[]:</span><br><span class="line">...         return (None, None)</span><br><span class="line">...     return (min(L),max(L))</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="列表生成式"><a href="#列表生成式" class="headerlink" title="列表生成式"></a>列表生成式</h4><ol>
<li><p>写列表生成式时，把要生成的元素x * x放到前面，后面跟for循环，就可以把list创建出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; [x * x for x in range(1, 11)]</span><br><span class="line">[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]</span><br><span class="line">&gt;&gt;&gt; [x * x for x in range(1, 11) if x % 2 == 0]</span><br><span class="line">[4, 16, 36, 64, 100] </span><br><span class="line">&gt;&gt;&gt; [m + n for m in &apos;ABC&apos; for n in &apos;XYZ&apos;]</span><br><span class="line">[&apos;AX&apos;, &apos;AY&apos;, &apos;AZ&apos;, &apos;BX&apos;, &apos;BY&apos;, &apos;BZ&apos;, &apos;CX&apos;, &apos;CY&apos;, &apos;CZ&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>练习题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; L1 = [&apos;Hello&apos;, &apos;World&apos;, 18, &apos;Apple&apos;, None]</span><br><span class="line">&gt;&gt;&gt; L2 = [s.lower() for s in L1 if isinstance(s, str)]</span><br><span class="line">&gt;&gt;&gt; print(L2)</span><br><span class="line">[&apos;hello&apos;, &apos;world&apos;, &apos;apple&apos;]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h4><ol>
<li><p>把一个列表生成式的[]改成()，就创建了一个generator.打印出generator的每一个元素,可以通过next()函数获得generator的下一个返回值.没有更多的元素时，抛出StopIteration的错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; g = (x * x for x in range(10))</span><br><span class="line">&gt;&gt;&gt; g</span><br><span class="line">&lt;generator object &lt;genexpr&gt; at 0x1022ef630&gt;</span><br><span class="line">&gt;&gt;&gt; next(g)</span><br><span class="line">0</span><br><span class="line">&gt;&gt;&gt; next(g)</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义generator的另一种方法：函数定义中包含yield关键字，(yield会输出值)那么这个函数就不再是一个普通函数，而是一个generator</p>
<blockquote>
<p>generator和函数的执行流程不一样。函数是顺序执行，遇到return语句或者最后一行函数语句就返回。
   而变成generator的函数，在每次调用next()的时候执行，遇到yield语句返回，再次执行时从上次返回的yield语句处继续执行。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">def odd():</span><br><span class="line">    print(&apos;step 1&apos;)</span><br><span class="line">    yield 1</span><br><span class="line">    print(&apos;step 2&apos;)</span><br><span class="line">    yield(3)</span><br><span class="line">    print(&apos;step 3&apos;)</span><br><span class="line">    yield(5)</span><br><span class="line">    调用该generator时，首先要生成一个generator对象，然后用next()函数不断获得下一个返回值</span><br><span class="line">&gt;&gt;&gt; o = odd()</span><br><span class="line">&gt;&gt;&gt; next(o)</span><br><span class="line">step 1</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; next(o)</span><br><span class="line">step 2</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>generator的工作原理，它是在for循环的过程中不断计算出下一个元素，并在适当的条件结束for循环。对于函数改成的generator来说，遇到return语句或者执行到函数体最后一行语句，就是结束generator的指令，for循环随之结束.</p>
</li>
<li>作业<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def triangles():</span><br><span class="line">...     L = [1]</span><br><span class="line">...     while True:</span><br><span class="line">...         yield L</span><br><span class="line">...         L = [x+y for x,y in zip( [0]+L, L+[0] )]</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; a=triangles()</span><br><span class="line">&gt;&gt;&gt; next(a)</span><br><span class="line">[1]</span><br><span class="line">&gt;&gt;&gt; next(a)</span><br><span class="line">[1, 1]</span><br><span class="line">&gt;&gt;&gt; next(a)</span><br><span class="line">[1, 2, 1]</span><br><span class="line">&gt;&gt;&gt; next(a)</span><br><span class="line">[1, 3, 3, 1]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h4><ol>
<li>可以直接作用于for循环的对象统称为可迭代对象：Iterable。可以使用isinstance()判断一个对象是否是Iterable对象(上面迭代有示例)</li>
<li><p>可以被next()函数调用并不断返回下一个值的对象称为迭代器：Iterator。它们表示一个惰性计算的序列.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from collections import Iterator</span><br><span class="line">&gt;&gt;&gt; isinstance((x for x in range(10)), Iterator)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance([], Iterator)</span><br><span class="line">False</span><br><span class="line"></span><br><span class="line">生成器都是Iterator对象，但list、dict、str虽然是Iterable，却不是Iterator。</span><br><span class="line">把list、dict、str等Iterable变成Iterator可以使用iter()函数</span><br><span class="line">  </span><br><span class="line">&gt;&gt;&gt; isinstance(iter([]), Iterator)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(iter(&apos;abc&apos;), Iterator)</span><br><span class="line">True</span><br></pre></td></tr></table></figure>
</li>
<li><p>为什么list、dict、str等数据类型不是Iterator？</p>
<blockquote>
<p>这是因为Python的Iterator对象表示的是一个数据流，Iterator对象可以被next()函数调用并不断返回下一个数据，直到没有数据时抛出StopIteration错误。
   可以把这个数据流看做是一个有序序列，但我们却不能提前知道序列的长度，只能不断通过next()函数实现按需计算下一个数据，所以Iterator的计算是惰性的，只有在需要返回下一个数据时它才会计算。
   Iterator甚至可以表示一个无限大的数据流，例如全体自然数。而使用list是永远不可能存储全体自然数的。</p>
</blockquote>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/23/python练级第一天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/23/python练级第一天/" itemprop="url">python练级第一天</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-23T15:31:12+08:00">
                2018-02-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="python练级打卡第一天"><a href="#python练级打卡第一天" class="headerlink" title="python练级打卡第一天"></a>python练级打卡第一天</h2><h4 id="语言类型"><a href="#语言类型" class="headerlink" title="语言类型"></a>语言类型</h4><ul>
<li>C语言编译型语言，python解释型语言（先编译后解释），java先编译后解释语言，c#是二次编译的纯编译语言。</li>
<li>解释型语言就是边解释边执行，而编译型语言是先编译后执行，两者的操作过程不同。</li>
<li><strong>注意</strong>：解释型语言从上往下执行，执行到函数时不会执行函数里面的语句，等到调用时再执行。而编译型语言会先找到main函数开始执行。</li>
<li>python 大小写敏感，缩进块 4个空格</li>
</ul>
<h4 id="python环境管理"><a href="#python环境管理" class="headerlink" title="python环境管理"></a>python环境管理</h4><ul>
<li>安装pyenv （python environment）, pyenv local 可以查看当前版本</li>
<li><p>版本间切换，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eval &quot;$(pyenv init -)&quot; &amp;&amp; pyenv local 3.6.2</span><br><span class="line">mac需要加上 eval &quot;$(pyenv init -)&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用pyenv安装不同的python版本, <strong>pyenv install –list</strong> 查看可以安装的列表。<strong>pyenv install 2.7.6</strong> 安装指定版本。</p>
</li>
</ul>
<h4 id="基础1"><a href="#基础1" class="headerlink" title="基础1"></a>基础1</h4><ul>
<li><p><strong>双引号和单引号的区别??</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;hello&quot;)</span><br><span class="line">print(&apos;hello&apos;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>python代码运行助手：在线输入Python代码，然后通过本机运行的一个Python脚本来执行代码</p>
</li>
<li><p>print()函数也可以接受多个字符串，用逗号“,”隔开，就可以连成一串输出. print()会依次打印每个字符串，遇到逗号“,”会输出一个空格.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print(&quot;I&quot;,&quot;am&quot;,&quot;a&quot;,&quot;dog&quot;)</span><br><span class="line">I am a dog</span><br></pre></td></tr></table></figure>
</li>
<li><p>input </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name = input(&apos;please enter your name: &apos;)</span><br><span class="line">print(&apos;hello,&apos;, name)</span><br></pre></td></tr></table></figure>
</li>
<li><p>output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;1024*768 =&apos;, 1024*768)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="基础2"><a href="#基础2" class="headerlink" title="基础2"></a>基础2</h4><ul>
<li>整数：十六进制用0x前缀和0-9，a-f表示, 例如：0xff00，0xa5b4c3d2等</li>
<li>浮点数：1.23x109就是1.23e9，或者12.3e8，0.000012可以写成1.2e-5。Python的浮点数没有大小限制，但是超出一定范围就直接表示为inf（无限大）</li>
<li>转义字符’\’, 可以对’，”，\n, \t, \ 等进行转义。Python还允许用r’’表示’’内部的字符串默认不转义</li>
<li>空值是Python里一个特殊的值，用None表示。None不能理解为0，因为0是有意义的，而None是一个特殊的空值。</li>
<li>动态语言（变量本身类型不固定，可随意赋值）和静态语言（定义变量时必须指定变量类型，如果赋值的时候类型不匹配会报错）。</li>
<li>常量一般用大写字母表示。 ‘10//3’为3，相除只取结果的整数部分。</li>
<li><p>for x in …循环就是把每个元素代入变量x，然后执行缩进块的语句。range()函数，可以生成一个整数序列，再通过list()函数可以转换为list。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; list(range(5))</span><br><span class="line">[0, 1, 2, 3, 4]</span><br></pre></td></tr></table></figure>
</li>
<li><p>while循环，只要条件满足，就不断循环，条件不满足时退出循环</p>
</li>
<li>在循环中，break语句可以提前退出循环。也可以通过continue语句，跳过当前的这次循环，直接开始下一次循环。这两个语句通常都必须配合if语句使用。下面例子只打印奇数。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">n = 0</span><br><span class="line">while n &lt; 10:</span><br><span class="line">    n = n + 1</span><br><span class="line">    if n % 2 == 0: # 如果n是偶数，执行continue语句</span><br><span class="line">        continue # continue语句会直接继续下一轮循环，后续的print()语句不会执行</span><br><span class="line">    print(n)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h4><ul>
<li>一个字节8比特。一个字节能表示的最大数（二进制11111111=十进制255）</li>
<li>在计算机内存中，统一使用Unicode编码，当需要保存到硬盘或者需要传输的时候，就转换为UTF-8编码。（UTF-8编码把一个Unicode字符根据不同的数字大小编码成1-6个字节，
常用的英文字母被编码成1个字节，汉字通常是3个字节，只有很生僻的字符才会被编码成4-6个字节）</li>
<li>用记事本编辑的时候，从文件读取的UTF-8字符被转换为Unicode字符到内存里，编辑完成后，保存的时候再把Unicode转换为UTF-8保存到文件</li>
<li>浏览网页的时候，服务器会把动态生成的Unicode内容转换为UTF-8再传输到浏览器。</li>
</ul>
<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><ul>
<li><p>ord()函数获取字符的整数表示，chr()函数把整数(编码后的)转换为对应的字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; ord(&apos;A&apos;)</span><br><span class="line">65</span><br><span class="line">&gt;&gt;&gt; chr(25991)</span><br><span class="line">&apos;文&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串是以Unicode编码的,一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把str变为以字节为单位的bytes, 用带b前缀的单引号或双引号表示。</p>
</li>
<li>在bytes中，无法显示为ASCII字符的字节，用\x##显示。<strong>疑问?</strong></li>
<li><p>以Unicode表示的str通过encode()方法可以编码为指定的bytes。如果我们从网络或磁盘上读取了字节流，读到的数据就是bytes。要把bytes变为str，就需要用decode()方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; b&apos;\xe4\xb8\xad\xe6\x96\x87&apos;.decode(&apos;utf-8&apos;)</span><br><span class="line">&apos;中文&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>纯英文的str可以用ASCII编码为bytes，内容是一样的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &apos;ABC&apos;.encode(&apos;ascii&apos;)</span><br><span class="line">b&apos;ABC&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>含有中文的str可以用UTF-8编码为bytes。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &apos;中文&apos;.encode(&apos;utf-8&apos;)</span><br><span class="line">b&apos;\xe4\xb8\xad\xe6\x96\x87&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>含有中文的str无法用ASCII编码，因为中文编码的范围超过了ASCII编码的范围，Python会报错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &apos;中文&apos;.encode(&apos;ascii&apos;)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">UnicodeEncodeError: &apos;ascii&apos; codec can&apos;t encode characters in position 0-1: ordinal not in range(128)</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果bytes中只有一小部分无效的字节，可以传入errors=’ignore’忽略错误的字节</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; b&apos;\xe4\xb8\xad\xe6&apos;.decode(&apos;utf-8&apos;, errors=&apos;ignore&apos;)</span><br><span class="line">&apos;中&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>len()函数计算的是str的字符数，如果换成bytes，len()函数就计算字节数。(1个中文字符经过UTF-8编码后通常会占用3个字节，而1个英文字符只占用1个字节。)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; len(&apos;中文&apos;)</span><br><span class="line">2</span><br><span class="line">&gt;&gt;&gt; len(&apos;中文&apos;.encode(&apos;utf-8&apos;))</span><br><span class="line">6</span><br></pre></td></tr></table></figure>
</li>
<li><p>当你的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为UTF-8编码。源码开头加入下面这行，为了告诉Python解释器，按照UTF-8编码读取源代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br></pre></td></tr></table></figure>
</li>
<li><p>占位符，%s==字符串，%x==十六进制整数。如果不太确定应该用什么，%s永远起作用，它会把任何数据类型转换为字符串。字符串里面的%是一个普通字符的时候就需要转义，用%%来表示一个%。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &apos;growth rate: %d %%&apos; % 7</span><br><span class="line">&apos;growth rate: 7 %&apos;</span><br><span class="line">&gt;&gt;&gt; print(&apos;%.2f&apos; % 3.1415926)</span><br><span class="line">3.14</span><br><span class="line">&gt;&gt;&gt; print(&apos;%2d-%02d&apos; % (3, 1)) </span><br><span class="line"> 3-01</span><br><span class="line">&gt;&gt;&gt; print(&apos;%d-%02d&apos; % (3, 1))</span><br><span class="line">3-01</span><br></pre></td></tr></table></figure>
</li>
<li><p>另一种格式化字符串的方法是使用字符串的format()方法，它会用传入的参数依次替换字符串内的占位符{0}、{1}……</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &apos;Hello, &#123;0&#125;, 成绩提升了 &#123;1:.1f&#125;%&apos;.format(&apos;小明&apos;, 17.125)</span><br><span class="line">&apos;Hello, 小明, 成绩提升了 17.1%&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="list列表"><a href="#list列表" class="headerlink" title="list列表"></a>list列表</h4><ul>
<li><p>变量classmates就是一个list，当索引超出了范围时，Python会报一个IndexError错误。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; classmates = [&apos;Michael&apos;, &apos;Bob&apos;, &apos;Tracy&apos;]</span><br><span class="line">&gt;&gt;&gt; classmates</span><br><span class="line">[&apos;Michael&apos;, &apos;Bob&apos;, &apos;Tracy&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以往list中追加元素到末尾</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; classmates.append(&apos;Adam&apos;)</span><br><span class="line">&gt;&gt;&gt; classmates</span><br><span class="line">[&apos;Michael&apos;, &apos;Bob&apos;, &apos;Tracy&apos;, &apos;Adam&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>把元素插入到指定的位置，比如索引号为1的位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; classmates.insert(1, &apos;Jack&apos;)</span><br><span class="line">&gt;&gt;&gt; classmates</span><br><span class="line">[&apos;Michael&apos;, &apos;Jack&apos;, &apos;Bob&apos;, &apos;Tracy&apos;, &apos;Adam&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>要删除list末尾的元素，用pop()方法。要删除指定位置的元素，用pop(i)方法，其中i是索引位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; classmates.pop()</span><br><span class="line">&apos;Adam&apos;</span><br><span class="line">&gt;&gt;&gt; classmates.pop(1)</span><br><span class="line">&apos;Jack&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>list里面的元素的数据类型也可以不同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; L = [&apos;Apple&apos;, 123, True]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="tuple元组"><a href="#tuple元组" class="headerlink" title="tuple元组"></a>tuple元组</h4><ul>
<li><p>tuple一旦初始化就不能修改。只有1个元素的tuple定义时必须加一个逗号,，来消除歧义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; classmates = (&apos;Michael&apos;, &apos;Bob&apos;, &apos;Tracy&apos;)</span><br><span class="line">&gt;&gt;&gt; t = (1,)</span><br><span class="line">&gt;&gt;&gt; t</span><br><span class="line">(1,)</span><br></pre></td></tr></table></figure>
</li>
<li><p>要创建一个内容也不变的tuple怎么做？那就必须保证tuple的每一个元素本身也不能变。，tuple的元素不包含list这种可变的元素。</p>
</li>
</ul>
<h4 id="dict字典"><a href="#dict字典" class="headerlink" title="dict字典"></a>dict字典</h4><ul>
<li><p>在其他语言中也称为map，使用键-值（key-value）存储，具有极快的查找速度，查字典一样。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; d = &#123;&apos;Michael&apos;: 95, &apos;Bob&apos;: 75, &apos;Tracy&apos;: 85&#125;</span><br><span class="line">&gt;&gt;&gt; d[&apos;Michael&apos;]</span><br><span class="line">95</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断key是否存在，一种是通过in，另一种是通过dict提供的get()方法，如果key不存在，可以返回None（返回None的时候Python的交互环境不显示结果），或者自己指定的value</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &apos;Thomas&apos; in d</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; d.get(&apos;Thomas&apos;)</span><br><span class="line">&gt;&gt;&gt; d.get(&apos;Thomas&apos;, -1)</span><br><span class="line">-1</span><br></pre></td></tr></table></figure>
</li>
<li><p>要删除一个key，用pop(key)方法，对应的value也会从dict中删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; d.pop(&apos;Bob&apos;)</span><br><span class="line">75</span><br><span class="line">&gt;&gt;&gt; d</span><br><span class="line">&#123;&apos;Michael&apos;: 95, &apos;Tracy&apos;: 85&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>和list比较，dict有以下几个特点：查找和插入的速度极快，不会随着key的增加而变慢；需要占用大量的内存，内存浪费多。
而list相反：查找和插入的时间随着元素的增加而增加；占用空间小，浪费内存很少。所以，dict是用空间来换取时间的一种方法。</p>
</blockquote>
<blockquote>
<p><strong>dict的key必须是不可变对象</strong>，字符串、整数等都是不可变的，可以放心地作为key。而list是可变的，就不能作为key.</p>
</blockquote>
<ul>
<li><p>让如下字典按照内容逐行显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; r</span><br><span class="line">&#123;&apos;Server&apos;: &apos;bfe/1.0.8.18&apos;, &apos;Content-Type&apos;: &apos;text/html&apos;, &apos;Connection&apos;: &apos;Keep-Alive&apos;, &apos;Date&apos;: &apos;Wed, 28 Feb 2018 11:03:41 GMT&apos;, &apos;Pragma&apos;: &apos;no-cache&apos;, &apos;Set-Cookie&apos;: &apos;BDORZ=27315&apos;&#125;</span><br><span class="line">&gt;&gt;&gt; for key,value in r.items():</span><br><span class="line">...     print(key, &quot;:&quot; , r[key])</span><br><span class="line">...</span><br><span class="line">Server : bfe/1.0.8.18</span><br><span class="line">Content-Type : text/html</span><br><span class="line">Connection : Keep-Alive</span><br><span class="line">Date : Wed, 28 Feb 2018 11:03:41 GMT</span><br><span class="line">Pragma : no-cache</span><br><span class="line">Set-Cookie : BDORZ=27315</span><br></pre></td></tr></table></figure>
</li>
<li></li>
</ul>
<h4 id="set：key的集合"><a href="#set：key的集合" class="headerlink" title="set：key的集合"></a>set：key的集合</h4><ul>
<li><p>在set中，没有重复的key,要创建一个set，需要提供一个list作为输入集合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = set([1, 2, 3])</span><br><span class="line">&gt;&gt;&gt; s</span><br><span class="line">&#123;1, 2, 3&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过add(key)方法可以添加元素到set中, 通过remove(key)方法可以删除元素</p>
</li>
<li>set和dict的唯一区别仅在于没有存储对应的value，但是，set的原理和dict一样，所以，同样不可以放入可变对象，因为无法判断两个可变对象是否相等，也就无法保证set内部“不会有重复元素”。
下面例子：字符串为不可变对象<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = &apos;abc&apos;</span><br><span class="line">&gt;&gt;&gt; b = a.replace(&apos;a&apos;, &apos;A&apos;)</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">&apos;Abc&apos;</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">&apos;abc&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>参考资料：
<a href="https://www.cnblogs.com/kym/archive/2012/05/14/2498728.html" target="_blank" rel="noopener">https://www.cnblogs.com/kym/archive/2012/05/14/2498728.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/08/加密/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kingvirre">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kingvirre">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/08/加密/" itemprop="url">加密</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-08T11:50:21+08:00">
                2018-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><h4 id="可逆加密：密钥对，一个加密，一个解密"><a href="#可逆加密：密钥对，一个加密，一个解密" class="headerlink" title="可逆加密：密钥对，一个加密，一个解密"></a>可逆加密：密钥对，一个加密，一个解密</h4><ul>
<li>对称加密，加密和解密的密钥相同，速度快，通信双方知道密钥。常见的有DES，3DES，AES对称加密。</li>
<li>非对称加密，加密和解密密钥不同，分为公钥和私钥，任何人都可以知道公钥，私钥自己持有进行解密。常见的有RSA。<h4 id="不可逆加密"><a href="#不可逆加密" class="headerlink" title="不可逆加密"></a>不可逆加密</h4></li>
<li>不需要使用密钥，输入明文后由系统直接经过加密算法处理成密文，这种加密后的数据是无法被解密的，只有重新输入明文，并再次经过同样不可逆的加密算法处理，得到相同的加密密文并被系统重新识别后，才能真正解密。</li>
<li>常见的有MD5</li>
</ul>
<h3 id="非对称加密"><a href="#非对称加密" class="headerlink" title="非对称加密"></a>非对称加密</h3><ul>
<li>基于RSA算法实现生成公钥和私钥，和CA协商生成签名</li>
<li>公钥负责加密，私钥负责解密；私钥负责签名，公钥负责验证。<h4 id="用户A和用户B信息传输："><a href="#用户A和用户B信息传输：" class="headerlink" title="用户A和用户B信息传输："></a>用户A和用户B信息传输：</h4></li>
<li>A准备好要传送的数字信息（明文），对数字信息进行哈希（hash）运算，得到一个信息摘要。</li>
<li>A用私钥对信息摘要进行加密得到签名，并将其附在数字信息上。</li>
<li>A用B的公钥对信息进行加密，将加密后的密文传送给B。</li>
<li>B收到A传送过来的密文，用自己的私钥对密文解密。用A的公钥对A的数字签名进行解密，得到信息摘要。</li>
<li>B用相同的hash算法对收到的明文再进行一次hash 运算，得到一个新的信息摘要。</li>
<li>B将收到的信息摘要和新产生的信息摘要进行比较，如果一致，说明收到的信息没有被修改过。</li>
</ul>
<p><code>但是上述过程存在问题，例如有用户C窃取A的电脑信息，把B的公钥修改成了自己的公钥，A用此公钥加密信息发给B，C在中间截获这个数据就可以获取这些私密信息。怎么应对这种情况呢？签名证书就派上用场了。</code></p>
<p>证书中心用自己的私钥，对每一个用户的公钥和一些相关信息一起加密，生成”数字证书”。发送者在发送信息之前如果想核对接受者的公钥，只需用CA的公钥对B的签名证书进行解密确认即可。</p>
<h2 id="SSH工作原理"><a href="#SSH工作原理" class="headerlink" title="SSH工作原理"></a>SSH工作原理</h2><ul>
<li>SSH就是一种网络协议，主要用于计算机之间的加密登录与数据传输</li>
<li>ssh user@host，省略前面的user，表示以当前本地登录的用户名登录host这台网络机器。</li>
<li>telnet协议“数据是明文传输的”，登录时传输的包括用户名和密码在内的所有信息都有可能会被恶意拦截而暴露。而SSH则是将登录信息全部加密后进行传输的，即使数据在传输过程中被截获，里面的密码已经被加密而不会泄露。<h4 id="主要步骤"><a href="#主要步骤" class="headerlink" title="主要步骤"></a>主要步骤</h4></li>
<li><strong>生成会话密钥</strong>：通过密钥协商技术生成密钥（对称加密的密钥）。这个密钥会通过<strong>被登录机器的公钥</strong>（非对称加密）进行加密后传输，此对称加密的密钥将用于后续所有通信。</li>
<li><strong>用户身份认证（登录）</strong>：是通过登录者的密钥对数据进行加解密验证实现的，这个过程中传输的所有数据都是通过上一步生成的密钥加密过的。</li>
<li><strong>数据加密同学</strong>：基于第1步生成的密钥进行数据加密传输。<h4 id="具体过程"><a href="#具体过程" class="headerlink" title="具体过程"></a>具体过程</h4></li>
<li>在主机A上向主机B发送连接请求；</li>
<li>主机B在与用户建立连接后，把自己的公钥发送给主机A；</li>
<li>主机A通过密钥协商技术产生一个随机密钥，然后使用主机B的公钥对这个随机密钥进行加密后发送给主机B;</li>
<li>主机B接收到主机A发送过来的密文形式的密钥后，通过自己的私钥进行解密，得到对称加密使用的密钥明文；至此，会话密钥已经生成完毕了；<strong>上述第一步完成</strong></li>
<li>主机A通过生成的会话密钥对账号和密码等信息进行加密然后发送给主机B；</li>
<li>主机B接收到加密信息后，使用会话密钥进行解密，从而得到明文的账号和密码进行账号验证；</li>
<li>主机B在验证账号和密码后通知主机A是否登录成功；<strong>身份认证</strong></li>
</ul>
<h4 id="验证公钥合法性"><a href="#验证公钥合法性" class="headerlink" title="验证公钥合法性"></a>验证公钥合法性</h4><p>上述步骤中，如果有主机C冒充主机B截获了登录请求，将自己伪造的公钥发送给主机A，尽管信息是加密过的，通信过程也是合法的，但是通信信息都被主机C截获了，其实这就是所谓的“中间人攻击”。其实，对主机B进行验证就是对主机B发送过来的公钥的合法性进行验证的过程。</p>
<ul>
<li>验证B的公钥的合法性，通过公钥数据指纹验证。发生在主机A接收到主机B发送的公钥之后，主机A向主机B协商产生会话密钥之前。</li>
<li>主机A会去当前用户家目录下的.ssh/known_hosts文件中查找是否存在该机器的公钥，如果不存在，表示主机A是第一次与该主机进行通信，那么主机A会计算出该公钥的数据指纹并要求用户对该指纹进行合法性确认，询问‘yes or no’。</li>
<li>用户需要把目标主机管理员公布的公钥的数据指纹与主机A计算得到的数据指纹进行比对，如果一致，则说明该公钥是合法的；如果不一致则说明不合法。</li>
<li>用户如果确认该公钥是合法的，则输入yes表示继续后面的连接，主机A则会把这个公钥的内容保存到当前用户家目录下的.ssh/known_hosts文件中，然后提示用户输入密码。</li>
<li><p>下次再登录，主机A发现该公钥已经在.ssh/known_hosts文件中存在了，就不用要求再次确认了，而是会直接提示输出密码。</p>
<blockquote>
<p>每个用户都有自己的kown_hosts文件，它们是相互独立的。我们也可以为所有用户保存一份公共的可信赖的远程主机的公钥，这个文件通常是/etc/ssh/ssh_known_hosts。</p>
</blockquote>
<p>假如之前我们通过ssh登录过的一台机器的IP被绑定到其他机器上了会出现什么情况？</p>
<blockquote>
<p>主机A发现主机B的公钥指纹对不上了，怀疑我们正在遭受中间人攻击（即有人在冒充主机B），并且密码验证方式和键盘交互验证方式都被禁止使用了。其实，我们自己知道是因为IP被绑定到其他机器上引起的这个问题，所以我们如果想继续登录新的主机B，只需要在.ssh/known_hosts文件中把原来保存的主机B的公钥删掉就可以了。</p>
</blockquote>
<h4 id="ssh免密钥登录：公钥认证"><a href="#ssh免密钥登录：公钥认证" class="headerlink" title="ssh免密钥登录：公钥认证"></a>ssh免密钥登录：公钥认证</h4><p>其实登录的过程就是被登录端对登录用户进行“身份验证”的过程，我们想在主机A上以root用户以SSH免密钥的方式登录主机B，登录验证过程是这样的：</p>
<ul>
<li>主机A与主机B协商产生会话密钥；</li>
<li>主机A会向主机B发送一个登录请求（如：<a href="mailto:root@192.168.1.2" target="_blank" rel="noopener">root@192.168.1.2</a>），发送的信息包括用户名root和root的公钥指纹，且所有信息都是通过会话密钥加密过的。</li>
<li>主机B通过会话密钥解密主机A发送的数据得到请求登录的用户名root和root的公钥指纹，然后读取root用户目录下的所有公钥数据（/root/.ssh/autorized_keys文件中），并分别通过单向加密算法获取各公钥的数据指纹与主机A发送过来的数据指纹做对比，从而找到主机A上的root用户的公钥；</li>
</ul>
</li>
<li>主机B使用找到的root用户的公钥对一个随机数进行加密发送发送给主机A；</li>
<li>主机A使用root用户的私钥对主机B发送的随机数密文进行解密，然后把解密结果发送给主机B;</li>
<li>主机B验证主机A解密后的数据与自己发送的数据一致，则对root用户的身份验证成功。<h4 id="ssh免密登录配置"><a href="#ssh免密登录配置" class="headerlink" title="ssh免密登录配置"></a>ssh免密登录配置</h4></li>
<li>生成密钥对：在机器A上，通过ssh-keygen命令生成一个ssh密钥对儿，一路回车；生成的密钥对儿默认保存在当前登录用户下的.ssh目录，也可以指定保存目录。我们当前是以root用户登录，因此是保存在/root/.ssh目录：</li>
<li>我们可以把这个密钥对儿中的两个文件复制到其他任意目录。但是一定要注意目录和文件的权限：.ssh 目录的权限必须是0700，authorized_keys文件权限必须是0600。</li>
<li>当在主机A上通过ssh root@hostB进行登录时，主机A会尝试读取登录用户目录下的私钥（这里是以root用户登录主机B，因此主机A会读取/root/.ssh/id_rsa文件作为私钥），也可以通过-i选项指定要使用的私钥文件；</li>
<li>我们需要手动把机器A公钥的内容复制到要登录机器B的相应用户（如root）家目录下的指定文件中：/home/root/.ssh/autorized_keys；</li>
<li>在机器A上就可以通过ssh私钥使用root用户登录机器B了。<blockquote>
<p>git项目，如果我们使用http/https协议的话，就需要提供用户名和密码进行验证；如果我们使用ssh协议的话，就可以把我们公钥保存到项目仓库机器的指定位置，来通过非对称加密的方式进行身份验证。</p>
</blockquote>
</li>
</ul>
<h2 id="https工作原理"><a href="#https工作原理" class="headerlink" title="https工作原理"></a>https工作原理</h2><p>HTTPS实际上就是HTTP协议和SSL/TSL协议的组合。使用HTTPS需要在服务器端配置密钥对；使用HTTPS需要花钱找专业的权威机构进行CA证书的签发。</p>
<ul>
<li>浏览器A与网站服务器B通过三次握手后建立网络连接。</li>
<li>浏览器A告诉服务器B：我想跟你通过HTTPS协议进行秘密交流。</li>
<li>网站服务器B把包含自己公钥信息的CA证书下发给浏览器A，并告诉浏览器A这个CA证书里有我的公钥信息，你决定一个对称加密使用的秘钥串，然后通过这个公钥加密后发送给我。</li>
<li>浏览器A接收到网站服务器B下发的CA证书后，对这个CA证书的及其包含的公钥信息的合法性表示怀疑。于是根据CA证书中包含的证书签发机构的标识找到自身内置的该签发机构的公钥对CA证书中公钥的数据指纹进行解密，然后再自己计算一下CA证书中公钥的数据指纹，对了一下这两个数据指纹是一致的。浏览器A放心了，知道这个CA证书是合法的，CA证书中的公钥也没有被篡改过。</li>
<li>然后浏览器A通过通过密钥协商技术产生了一个随机的字符串作为与网站服务器B进行秘密通信的密钥，并把这个密钥通过CA证书中包含的公钥进行加密后发送给网站服务器B。</li>
<li>网站服务器B接收到密文格式的密钥后，通过自己的私钥进行解密得到密钥的明文内容。</li>
<li>浏览器A和网站服务器B开始了交流。</li>
</ul>
<p>参考资料：
<a href="https://www.cnblogs.com/yyds/p/6992125.html" target="_blank" rel="noopener">https://www.cnblogs.com/yyds/p/6992125.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/blog-logo.jpg"
                alt="Kingvirre" />
            
              <p class="site-author-name" itemprop="name">Kingvirre</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">31</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">

&copy; 
<span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Kingvirre</span>
</div>

  <div class="powered-by">
  <i class="fa fa-user-md"></i>
  <span id="busuanzi_container_site_uv"> <span id="busuanzi_value_site_uv"></span></span>
  </div>

  <div class="theme-info">
  访客量 &mdash;
  </div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
<script type="text/javascript" src="/js/src/love.js"></script>
